name: PHP Insights
on: pull_request
jobs:
  insights:
    name: PHP Insights
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: symfony
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: MySQL
        uses: mirromutth/mysql-action@v1.1
        with:
          mysql root password: mysqlactions 
      - name: Composer
        uses: php-actions/composer@v4
        env:
          DATABASE_URL: mysql://root:mysqlactions@127.0.0.1:3306/test 
        with:
          working_dir: symfony
      - name: Insights
        uses: worksome/phpinsights-app@v0.1
        with:
          repo_token: "${{ secrets.GITHUB_TOKEN }}"
          workingDir: './symfony'
          memory_limit: '1024M'
      
